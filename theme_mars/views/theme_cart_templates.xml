<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!--    Mars cart layout-->
    <template id="mars_shop_cart" inherit_id="website_sale.cart"
              name="Mars_Shop_Cart">
        <xpath expr="//div[hasclass('oe_website_sale')]" position="replace">
            <section id="carts" class="container wrapper">
                <div class="container oe_website_sale py-2">
                    <div class="row">
                        <div class="col-12" style="display:none;">
                            <t t-call="website_sale.wizard_checkout">
                                <t t-set="step" t-value="10"/>
                            </t>
                        </div>
                        <div class=" oe_cart">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div t-if="abandoned_proceed or access_token"
                                         class="mt8 mb8 alert alert-info"
                                         role="alert"> <!-- abandoned cart choices -->
                                        <t t-if="abandoned_proceed">
                                            <p>Your previous cart has
                                                already been completed.
                                            </p>
                                            <p t-if="website_sale_order">
                                                Please proceed your current
                                                cart.
                                            </p>
                                        </t>
                                        <t t-if="access_token">
                                            <p>This is your current cart.
                                            </p>
                                            <p>
                                                <strong>
                                                    <a t-attf-href="/shop/cart/?access_token=#{access_token}&amp;revive=squash">
                                                        Click here
                                                    </a>
                                                </strong>
                                                if you want to restore your
                                                previous cart. Your current
                                                cart will be replaced with
                                                your previous cart.
                                            </p>
                                            <p>
                                                <strong>
                                                    <a t-attf-href="/shop/cart/?access_token=#{access_token}&amp;revive=merge">
                                                        Click here
                                                    </a>
                                                </strong>
                                                if you want to merge your
                                                previous cart into current
                                                cart.
                                            </p>
                                        </t>
                                    </div>
                                    <t t-call="website_sale.cart_lines"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div t-if="website_sale_order and website_sale_order.website_order_line"
                 class="container">
                <form t-att-action="'/shop/pricelist%s' % (redirect and '?r=' + redirect or '')"
                      method="post" name="coupon_code" class="coupon_mars">
                    <input type="hidden" name="csrf_token"
                           t-att-value="request.csrf_token()"/>
                    <div class="coupon">
                        <div class="row justify-content-between">
                            <div class="col-lg-4 col-12">
                                <div class="sidebar_searchbox">
                                    <div class="input-group w-100">
                                        <input name="promo"
                                               class="form-control"
                                               type="text"
                                               placeholder="Coupon code..."
                                               t-att-value="website_sale_order.pricelist_id.code or None"/>
                                        <a href="#" role="button"
                                           class="btn btn-secondary a-submit">
                                            Apply
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p class="coupon_para">Enter any valid coupon or promo
                        code
                        here to redeem your
                        discount.
                    </p>
                </form>
                <t t-if="request.params.get('code_not_available')"
                   name="code_not_available">
                    <div class="alert alert-danger text-start" role="alert">
                        This
                        promo code is not available.
                    </div>
                </t>
            </div>
            <section id="cart-sum" class="container wrapper">
                <t t-set="so_obj" t-value="website_sale_order.read()[0]"/>
                <div class="coupon"
                     t-if="website_sale_order and website_sale_order.website_order_line">
                    <div class="cart_bottom">
                        <div class="">
                            <div class="">
                                <div class="cards js_cart_summary"
                                     t-if="website_sale_order and website_sale_order.website_order_line">
                                    <div class="card-body">
                                        <h4 class="d-none d-xl-block">Order
                                            Total
                                        </h4>
                                        <div>
                                            <div class="subtotal"
                                                 id="cart_total"
                                                 t-att-class="extra_class or ''"
                                                 t-if="website_sale_order and website_sale_order.website_order_line">
                                                <table class="table">
                                                    <tbody>
                                                        <tr id="empty">
                                                            <t t-if='not no_rowspan'>
                                                                <td rowspan="10"
                                                                    class="border-0"/>
                                                            </t>
                                                            <td class="col-md-2 col-3 border-0"/>
                                                            <td class="col-md-2 col-3 border-0"/>
                                                        </tr>
                                                        <tr>
                                                            <tr id="order_total_untaxed">
                                                                <td class="text-end border-0 text_ends">
                                                                    Subtotal:
                                                                </td>
                                                                <td class="text-xl-end border-0">
                                                                    <span t-field="website_sale_order.amount_untaxed"
                                                                          class="monetary_field"
                                                                          style="white-space: nowrap;"
                                                                          t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                                                </td>
                                                            </tr>
                                                            <tr id="order_total_taxes">
                                                                <td class="text-end border-0 text_ends">
                                                                    Taxes:
                                                                </td>
                                                                <td class="text-xl-end border-0">
                                                                    <span t-field="website_sale_order.amount_tax"
                                                                          class="monetary_field"
                                                                          style="white-space: nowrap;"
                                                                          t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                                                </td>
                                                            </tr>
                                                        </tr>
                                                        <tr id="order_total">
                                                            <td class="text-end border-top border-bottom-0 text_ends">
                                                                <strong>
                                                                    Total
                                                                </strong>
                                                            </td>
                                                            <td class="text-right text-xl-end border-top border-bottom-0">
                                                                <strong t-field="website_sale_order.amount_total"
                                                                        class="monetary_field"
                                                                        t-options='{"widget": "monetary", "display_currency": website_sale_order.pricelist_id.currency_id}'/>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <div class="btn_wrapper">
                                                    <a role="button"
                                                       class="btn btn-primary"
                                                       href="/shop/checkout?express=1">
                                                        Proceed to checkout
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </xpath>
    </template>
    <!--        Cart line layout-->
    <template id="mars_cart_lines" inherit_id="website_sale.cart_lines"
              name="Mars Cart Lines">
        <xpath expr="//table[@id='cart_products']" position="replace">
            <table t-if="website_sale_order and website_sale_order.website_order_line"
                   class="table table-striped table-sm js_cart_lines"
                   id="cart_products">
                <t t-set="show_qty"
                   t-value="is_view_active('website_sale.product_quantity')"/>
                <thead>
                    <tr>
                        <th scope="col"
                            class="td-img text-center td-action">Product
                        </th>
                        <th scope="col"/>
                        <th scope="col" class="text-center td-qty">
                            <t t-if="show_qty">
                                Quantity
                            </t>
                        </th>
                        <th scope="col" class="text-center td-price">Price
                        </th>
                        <th scope="col" class="text-center td-price">Total
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="website_sale_order.website_order_line"
                       t-as="line">
                        <tr t-att-class="'optional_product info' if line.linked_line_id else None"
                            class="cstm_tbl">
                            <td t-if="not line.product_id" colspan="2"
                                class='td-img cstm_tbl'/>
                            <t t-else="">
                                <td align="center"
                                    class='td-img cstm_tbl image_td'>
                                    <div class="product_img">
                                        <div class="row">
                                            <div class="col-md-1">
                                                <a href='#'
                                                   aria-label="Remove from cart"
                                                   title="Remove from cart"
                                                   class='delete js_delete_product no-decoration mt-5'>
                                                    <div class="col remove">
                                                        <div class="close-circle"
                                                             style="margin-top: 50px;">
                                                            <i class="bi bi-x"
                                                               aria-hidden="false"/>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                            <div class="col-md-11">
                                                <span t-if="line._is_not_sellable_line() and line.product_id.image_128"
                                                      class="img_wrapper">
                                                    <img t-att-src="image_data_uri(line.product_id.image_128)"
                                                         class="sample"
                                                         t-att-alt="line.name_short"/>
                                                </span>
                                                <span t-else=""
                                                      t-field="line.product_id.image_128"
                                                      t-options="{'widget': 'image', 'qweb_img_responsive': False, 'class': 'sample'}"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td class='td-product_name cstm_tbl'>
                                    <div>
                                        <t t-call="website_sale.cart_line_product_link">
                                            <p class="item-name">
                                                <strong t-field="line.name_short"/>
                                            </p>
                                        </t>
                                    </div>
                                    <p class="item-about">
                                        <t t-esc="line.product_id.categ_id.name"/>
                                    </p>
                                    <div class="product-indicate">
                                        <div class="indicate-content"/>
                                    </div>
                                </td>
                            </t>
                            <td class="text-center td-qty cstm_tbl">
                                <div class="css_quantity input-group mx-auto justify-content-center">
                                    <t t-if="not line._is_not_sellable_line()">
                                        <t t-if="show_qty">
                                            <div class="counter">
                                                <div class="box-container">
                                                    <a t-attf-href="#"
                                                       class="btn btn-link js_add_cart_json d-none d-md-inline-block border_link"
                                                       aria-label="Remove one"
                                                       title="Remove one">
                                                        <i class="fa fa-minus"/>
                                                    </a>
                                                    <input type="text"
                                                           class="js_quantity form-control quantity"
                                                           t-att-data-line-id="line.id"
                                                           t-att-data-product-id="line.product_id.id"
                                                           t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty"/>
                                                    <t t-if="line._get_shop_warning(clear=False)">
                                                        <a t-attf-href="#"
                                                           class="btn btn-link">
                                                            <i class='fa fa-warning text-warning'
                                                               t-att-title="line._get_shop_warning()"
                                                               role="img"
                                                               aria-label="Warning"/>
                                                        </a>
                                                    </t>
                                                    <a t-else=''
                                                       t-attf-href="#"
                                                       class="btn btn-link float_left js_add_cart_json d-none d-md-inline-block border_link"
                                                       aria-label="Add one"
                                                       title="Add one">
                                                        <i class="fa fa-plus"/>
                                                    </a>
                                                </div>
                                            </div>
                                        </t>
                                        <t t-else="">
                                            <input type="hidden"
                                                   class="js_quantity form-control quantity"
                                                   t-att-data-line-id="line.id"
                                                   t-att-data-product-id="line.product_id.id"
                                                   t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty"/>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <span class="text-muted w-100"
                                              t-esc="int(line.product_uom_qty)"/>
                                        <input type="hidden"
                                               class="js_quantity form-control quantity"
                                               t-att-data-line-id="line.id"
                                               t-att-data-product-id="line.product_id.id"
                                               t-att-value="line.product_uom_qty"/>
                                    </t>
                                </div>
                            </td>
                            <td class="text-center td-price cstm_tbl"
                                name="price">
                                <t groups="account.group_show_line_subtotals_tax_excluded">
                                    <span t-field="line.price_reduce_taxexcl"
                                          style="white-space: nowrap;"
                                          t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                </t>
                                <t groups="account.group_show_line_subtotals_tax_included">
                                    <span t-field="line.price_reduce_taxinc"
                                          style="white-space: nowrap;"
                                          t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                </t>
                                <t t-if="line.discount">
                                    <del t-attf-class="#{'text-danger mr8'}"
                                         style="white-space: nowrap;"
                                         t-esc="line.price_unit"
                                         t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                </t>
                            </td>
                            <td class="cstm_tbl" align="center">
                                <t t-esc="website_sale_order.currency_id.symbol"/>
                                <t t-esc="line.price_subtotal"/>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </xpath>
    </template>
    <!--        Cart summery layout-->
    <template id="cart_summery" inherit_id="website_sale.cart_lines">
        <xpath expr="//div[hasclass('alert')]" position="replace">
            <div class="cart_empty js_cart_lines"
                 t-if="not website_sale_order or not website_sale_order.website_order_line">
                <div class="cart_heading text-center">
                    <h1>Your cart is currently empty.
                    </h1>
                    <a role="button" href="/shop"
                       class="btn btn-secondary mb32">
                        <span>Continue
                            <span class="d-none d-md-inline">Shopping</span>
                        </span>
                    </a>
                </div>
            </div>
        </xpath>
    </template>
</odoo>
